<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  {{ $styles := resources.Get "css/main.css" | postCSS (dict "config"
    "./assets/css/postcss.config.js")
  }}
  {{ if .Site.IsServer }}
    <link rel="stylesheet" type="text/css" href="{{ $styles.RelPermalink }}" />
  {{ else }}
    {{ $styles := $styles | minify | fingerprint |
      resources.PostProcess
    }}
    {{/* https://discourse.gohugo.io/t/css-postprocess-and-relpermalink-issue/29650/5 */}}
    {{ $deep := strings.Count "/" (strings.TrimPrefix .Site.BaseURL .Permalink) }}
    {{ $deep = sub $deep 1 }}
    {{ $relbase := "." }}
    {{ if gt $deep 0 }}
      {{ $relbase = "" }}
      {{ range $i, $sequence := (seq $deep) }}
        {{ $relbase = (print $relbase "../") }}
      {{ end }}
      {{ $relbase = strings.TrimSuffix "/" $relbase }}
    {{ end }}
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ $relbase }}{{ $styles.RelPermalink }}"
      integrity="{{ $styles.Data.Integrity }}"
    />
  {{ end }}
  {{ $title := print .Site.Title " | " .Title }}
  {{ if .IsHome }}
    {{ $title =
      .Site.Title
    }}
  {{ end }}
  <title>{{ $title }}</title>
</head>
